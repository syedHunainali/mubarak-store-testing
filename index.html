<!DOCTYPE html>
<html lang="en">

<head>
    <meta
        content="Buy herbal products online from Mubarak Pansar - Karachi's trusted source for 100% natural remedies, dry fruits, honey, seeds, and supplements."
        name="description" />
    <meta
        content="pensar, pansar, mubarakpansar, mubarakpensar, herbal store karachi, herbs in karachi, natural remedies pakistan, herbal online store, cold pressed oils, herbal tea, seeds, supplements, dry fruits, essential oils, Karachi herbal store"
        name="keywords" />
    <meta content="Mubarak Pansar" name="author" />
    <meta content="Mubarak Pansar - Herbal Remedies &amp; Natural Products Online" property="og:title" />
    <meta
        content="Explore 100% natural herbal remedies, essential oils, and more at Karachi‚Äôs best online herbal store."
        property="og:description" />
    <meta content="https://herbal-pansar.web.app/images/logo.png" property="og:image" />
    <meta content="https://herbal-pansar.web.app/" property="og:url" />
    <meta content="website" property="og:type" />
    <meta content="summary_large_image" name="twitter:card" />
    <meta content="Mubarak Pansar - Karachi's Herbal Experts" name="twitter:title" />
    <meta content="Buy herbal supplements, oils, and teas in Pakistan from a trusted Karachi pansar store."
        name="twitter:description" />
    <meta content="https://herbal-pansar.web.app/images/logo.png" name="twitter:image" />
    <script type="application/ld+json">
   {
      "@context": "https://schema.org",
      "@type": "Store",
      "name": "Mubarak Pansar",
      "image": "https://herbal-pansar.web.app/images/logo.png",
      "url": "https://herbal-pansar.web.app/",
      "description": "Pakistan‚Äôs leading herbal store in Karachi. Natural herbal remedies, oils, supplements, and teas.",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Karachi",
        "addressCountry": "PK"
      },
      "sameAs": [
        "https://facebook.com/mubarakpansar",
        "https://instagram.com/mubarakpansar"
      ]
    }
  </script>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>
        Mubarak-pansar - Pakistan Leading Herbal Online Store
    </title>
    <link href="styles.css" rel="stylesheet" />
</head>

<body>
    <div class="modal-overlay hidden" id="custom-modal">
        <div class="modal-content">
            <p id="modal-message">
                This is a message.
            </p>
            <button class="btn btn-primary modal-close-btn" id="modal-close-btn">
                Close
            </button>
        </div>
    </div>
    <div class="mobile-search-overlay" id="mobile-search-overlay">
        <div class="mobile-search-container">
            <div class="mobile-search-header">
                <input class="mobile-search-input" id="mobile-search-input" placeholder="Search products..."
                    type="search" />
                <button class="mobile-search-close" onclick="closeMobileSearch()">
                    √ó
                </button>
            </div>
            <div class="mobile-search-results">
                <div class="product-grid" id="mobile-search-results-grid">
                </div>
            </div>
        </div>
    </div>
    <div class="mobile-menu-overlay" id="mobile-menu-overlay">
        <div class="mobile-menu-sidebar" id="mobile-menu-sidebar">
            <div class="mobile-menu-header">
                <h3>
                    Menu
                </h3>
                <button class="mobile-menu-close" onclick="closeMobileMenu()">
                    √ó
                </button>
            </div>
            <div class="mobile-menu-items">
                <a class="mobile-menu-item" href="#" onclick="showPage('home'); closeMobileMenu();">
                    HOME
                </a>
                <a class="mobile-menu-item" href="#" onclick="showPage('dry-fruits'); closeMobileMenu();">
                    DRY FRUITS
                </a>
                <a class="mobile-menu-item" href="#" onclick="showPage('herbal-tea'); closeMobileMenu();">
                    HERBAL TEA
                </a>
                <a class="mobile-menu-item" href="#" onclick="showPage('honey'); closeMobileMenu();">
                    HONEY
                </a>
                <a class="mobile-menu-item" href="#" onclick="showPage('seeds'); closeMobileMenu();">
                    SEEDS
                </a>
                <a class="mobile-menu-item" href="#" onclick="showPage('supplements'); closeMobileMenu();">
                    SUPPLEMENTS
                </a>
                <a class="mobile-menu-item" href="#" onclick="showPage('capsules'); closeMobileMenu();">
                    CAPSULES
                </a>
                <a class="mobile-menu-item" href="#" onclick="showPage('cold-pressed-oil'); closeMobileMenu();">
                    COLD
                    PRESSED OIL
                </a>
                <a class="mobile-menu-item" href="#" onclick="showPage('essential-oils'); closeMobileMenu();">
                    ESSENTIAL
                    OILS
                </a>
                <a class="mobile-menu-item" href="#" onclick="showPage('deals'); closeMobileMenu();">
                    DEALS
                </a>
            </div>
        </div>
    </div>
    <header class="header" id="main-header">
        <div class="header-tools">
            <button class="mobile-menu-btn" onclick="openMobileMenu()">
                ‚ò∞
            </button>
            <div class="logo">
                <a href="#" onclick="showPage('home')">
                    <img alt="Herbal Store Logo" src="images/logo.png" />
                </a>
            </div>
            <div class="search-wrapper">
                <input class="search-input" id="search-input" placeholder="Search products..." type="search" />
            </div>
            <div class="header-right-controls">
                <button class="mobile-search-btn" onclick="openMobileSearch()">
                    üîç
                </button>
                <div id="auth-controls">
                    <a href="#" onclick="showPage('login')">
                        Login
                    </a>
                </div>
                <div class="cart-total-display">
                    Total: PKR
                    <span id="cart-total-header">
                        0.00
                    </span>
                </div>
                <div class="cart-button" onclick="showPage('cart')">
                    <img alt="your cart" height="30" src="images/cart.png" width="30" />
                    <span class="cart-item-count-badge">
                        0
                    </span>
                </div>
            </div>
        </div>
        <div class="nav-container">
            <nav>
                <ul class="nav-menu">
                    <li>
                        <a class="nav-link" href="#" onclick="showPage('home')">
                            HOME
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#" onclick="showPage('dry-fruits')">
                            DRY FRUITS
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#" onclick="showPage('herbal-tea')">
                            HERBAL TEA
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#" onclick="showPage('honey')">
                            HONEY
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#" onclick="showPage('seeds')">
                            SEEDS
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#" onclick="showPage('supplements')">
                            SUPPLEMENTS
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#" onclick="showPage('capsules')">
                            CAPSULES
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#" onclick="showPage('cold-pressed-oil')">
                            COLD PRESSED OIL
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#" onclick="showPage('essential-oils')">
                            ESSENTIAL OILS
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#" onclick="showPage('deals')">
                            DEALS
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
        <div class="top-banner">
            *Free Shipping For Order Above Rs.2000 **Pakistan's Best Herbal Online Store
        </div>
    </header>
    <main>
        <div class="page" id="home-page">
            <div class="slider-container">
                <div class="slide fade">
                    <img alt="buy now" src="images/Banner1.png" />
                    <div class="slide-content">
                        <h1>
                            Discover Nature's Finest Remedies
                        </h1>
                        <p>
                            Your trusted source for natural health and wellness products.
                        </p>
                        <a class="btn" href="#" onclick="showPage('supplements')">
                            Shop Now
                        </a>
                    </div>
                </div>
                <div class="slide fade">
                    <img alt="buy now" src="images/Banner1.png" />
                    <div class="slide-content">
                        <h1>
                            Premium Quality Honey
                        </h1>
                        <p>
                            100% Pure and Organic Honey varieties.
                        </p>
                        <a class="btn btn-secondary" href="#" onclick="showPage('honey')">
                            Explore Honey
                        </a>
                    </div>
                </div>
                <div class="slide fade">
                        <img alt="buy now" src="images/Banner1.png" />                    <div class="slide-content">
                        <h1>
                            Fresh Dry Fruits
                        </h1>
                        <p>
                            Packed with nutrients for a healthy lifestyle.
                        </p>
                        <a class="btn" href="#" onclick="showPage('dry-fruits')">
                            View Collection
                        </a>
                    </div>
                </div>
                <a class="prev" onclick="plusSlides(-1)">
                    ‚ùÆ
                </a>
                <a class="next" onclick="plusSlides(1)">
                    ‚ùØ
                </a>
                <div class="dots-container">
                    <span class="dot" onclick="currentSlideDot(1)">
                    </span>
                    <span class="dot" onclick="currentSlideDot(2)">
                    </span>
                    <span class="dot" onclick="currentSlideDot(3)">
                    </span>
                </div>
            </div>
            <section class="collections-section">
                <div class="container">
                    <h2 class="collection-title">
                        Shop By Collection
                    </h2>
                    <div class="collection-grid">
                        <div class="collection-item" onclick="showPage('dry-fruits')">
                            <div class="collection-image">
                                <img alt="Dry Fruits"
                                    src="images/collection-1.png" />
                            </div>
                            <h4>
                                Dry Fruits
                            </h4>
                        </div>
                        <div class="collection-item" onclick="showPage('herbal-tea')">
                            <div class="collection-image">
                                <img alt="Herbal Tea"
                                    src="images/collection-2.png" />
                            </div>
                            <h4>
                                Herbal Tea
                            </h4>
                        </div>
                        <div class="collection-item" onclick="showPage('honey')">
                            <div class="collection-image">
                                <img alt="Honey" src="images/collection-3.png" />
                            </div>
                            <h4>
                                Honey
                            </h4>
                        </div>
                        <div class="collection-item" onclick="showPage('seeds')">
                            <div class="collection-image">
                                <img alt="Seeds" src="images/collection-4.png" />
                            </div>
                            <h4>
                                Seeds
                            </h4>
                        </div>
                        <div class="collection-item" onclick="showPage('supplements')">
                            <div class="collection-image">
                                <img alt="Supplements"
                                    src="images/collection-5.png" />
                            </div>
                            <h4>
                                Supplements
                            </h4>
                        </div>
                        <div class="collection-item" onclick="showPage('essential-oils')">
                            <div class="collection-image">
                                <img alt="Essential Oils" src="images/collection-6.png" />
                            </div>
                            <h4>
                                Essential Oils
                            </h4>
                        </div>
                    </div>
                </div>
            </section>
            <section class="products page-content">
                <div class="container">
                    <h2 class="section-title">
                        All Products
                    </h2>
                    <div class="product-grid" id="all-products-grid">
                    </div>
                </div>
            </section>
        </div>
        <div class="page hidden" id="dry-fruits-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Dry Fruits
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container">
                    <div class="product-grid" id="dry-fruits-grid">
                    </div>
                </div>
            </div>
        </div>
        <div class="page hidden" id="herbal-tea-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Herbal Tea
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container">
                    <div class="product-grid" id="herbal-tea-grid">
                    </div>
                </div>
            </div>
        </div>
        <div class="page hidden" id="honey-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Honey
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container">
                    <div class="product-grid" id="honey-grid">
                    </div>
                </div>
            </div>
        </div>
        <div class="page hidden" id="seeds-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Seeds
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container">
                    <div class="product-grid" id="seeds-grid">
                    </div>
                </div>
            </div>
        </div>
        <div class="page hidden" id="supplements-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Supplements
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container">
                    <div class="product-grid" id="supplements-grid">
                    </div>
                </div>
            </div>
        </div>
        <div class="page hidden" id="capsules-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Capsules
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container">
                    <div class="product-grid" id="capsules-grid">
                    </div>
                </div>
            </div>
        </div>
        <div class="page hidden" id="cold-pressed-oil-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Cold Pressed Oil
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container">
                    <div class="product-grid" id="cold-pressed-oil-grid">
                    </div>
                </div>
            </div>
        </div>
        <div class="page hidden" id="essential-oils-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Essential Oils
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container">
                    <div class="product-grid" id="essential-oils-grid">
                    </div>
                </div>
            </div>
        </div>
        <div class="page hidden" id="deals-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Deals
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container">
                    <div class="product-grid" id="deals-grid">
                    </div>
                </div>
            </div>
        </div>
        <div class="page hidden" id="search-results-page">
            <div class="page-header">
                <div class="container">
                    <h1 id="search-results-title">
                        Search Results
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container">
                    <div class="product-grid" id="search-results-grid">
                    </div>
                </div>
            </div>
        </div>
        <div class="page hidden" id="product-detail-page">
            <div class="page-content">
                <div class="container" id="product-detail-content">
                </div>
            </div>
        </div>
        <div class="page hidden" id="cart-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Shopping Cart
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container" id="cart-view-container">
                </div>
            </div>
        </div>
        <div class="page hidden" id="checkout-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Checkout
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container checkout-container">
                    <div class="checkout-form">
                        <h3>
                            Shipping Details
                        </h3>
                        <form id="checkout-form-element">
                            <div class="form-group">
                                <label for="fullName">
                                    Full Name
                                </label>
                                <input id="fullName" name="Full Name" required="" type="text" />
                            </div>
                            <div class="form-group hidden" id="guest-email-group">
                                <label for="email">
                                    Email
                                    Address
                                </label>
                                <input id="email" name="Email" required="" type="email" />
                            </div>
                            <div class="form-group">
                                <label for="phone">
                                    Phone Number
                                </label>
                                <input id="phone" name="Phone Number" required="" type="tel" />
                            </div>
                            <div class="form-group">
                                <label for="address">
                                    Full Address
                                </label>
                                <textarea id="address" name="Address" required="" rows="4"></textarea>
                            </div>
                            <div class="payment-methods">
                                <h3>
                                    Payment Method
                                </h3>
                                <div class="payment-method-tabs">
                                    <div class="payment-tab active" onclick="showPaymentContent('cod')">
                                        Cash on Delivery
                                    </div>
                                    <div class="payment-tab" onclick="showPaymentContent('easypaisa')">
                                        EasyPaisa
                                    </div>
                                    <div class="payment-tab" onclick="showPaymentContent('card')">
                                        Card Payment
                                    </div>
                                </div>
                                <div class="payment-content" id="cod-content">
                                    <p>
                                        You will pay when your order is delivered.
                                    </p>
                                </div>
                                <div class="payment-content hidden" id="easypaisa-content">
                                    <p>
                                        Please transfer the total amount to the following EasyPaisa account and enter
                                        the
                                        Transaction ID below:
                                    </p>
                                    <p>
                                        <b>
                                            Account Title:
                                        </b>
                                        Herbal Store PK
                                        <br />
                                        <b>
                                            Account Number:
                                        </b>
                                        0300-1234567
                                    </p>
                                    <div class="form-group" style="margin-top: 15px;">
                                        <label for="easypaisa-tid">
                                            Transaction ID (TID)
                                        </label>
                                        <input id="easypaisa-tid" name="EasyPaisa TID"
                                            placeholder="Enter your payment TID" type="text" />
                                    </div>
                                </div>
                                <div class="payment-content hidden" id="card-content">
                                    <div class="form-group">
                                        <label for="card-number">
                                            Card Number
                                        </label>
                                        <input id="card-number" name="Card Number" placeholder="XXXX XXXX XXXX XXXX"
                                            type="text" />
                                    </div>
                                    <div class="form-group" style="display: flex; gap: 10px;">
                                        <div style="flex: 1;">
                                            <label for="card-expiry">
                                                Expiry (MM/YY)
                                            </label>
                                            <input id="card-expiry" name="Card Expiry" placeholder="MM/YY"
                                                type="text" />
                                        </div>
                                        <div style="flex: 1;">
                                            <label for="card-cvc">
                                                CVC
                                            </label>
                                            <input id="card-cvc" name="Card CVC" placeholder="XXX" type="text" />
                                        </div>
                                    </div>
                                    <div class="payment-warning">
                                        <strong>
                                            For Demo Purposes Only.
                                        </strong>
                                        Do not enter
                                        real credit card information.
                                    </div>
                                </div>
                            </div>
                            <button class="btn-primary" style="margin-top: 20px;" type="submit">
                                Place Order
                            </button>
                        </form>
                    </div>
                    <div class="order-summary">
                        <h3>
                            Your Order
                        </h3>
                        <div id="checkout-summary-container">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="page hidden" id="order-success-page">
            <div class="page-content" style="text-align: center;">
                <div class="container">
                    <h2>
                        ‚úÖ Thank You!
                    </h2>
                    <p>
                        Your order has been placed successfully.
                    </p>
                    <p>
                        We will contact you shortly to confirm the details.
                    </p>
                    <button class="btn-primary" onclick="showPage('home'); cart = []; updateCartDisplay();"
                        style="margin-top: 20px; width: auto;">
                        Continue Shopping
                    </button>
                </div>
            </div>
        </div>
        <div class="page hidden" id="login-page">
            <div class="auth-page">
                <div class="auth-container">
                    <form id="login-form">
                        <h2>
                            Login
                        </h2>
                        <div class="form-group">
                            <label for="login-email">
                                Email
                            </label>
                            <input id="login-email" required="" type="email" />
                        </div>
                        <div class="form-group">
                            <label for="login-password">
                                Password
                            </label>
                            <input id="login-password" required="" type="password" />
                        </div>
                        <button class="btn btn-primary" type="submit">
                            Login
                        </button>
                        <p class="toggle-auth">
                            Don't have an account?
                            <a onclick="toggleAuthForms()">
                                Sign Up
                            </a>
                        </p>
                    </form>
                    <form class="hidden" id="signup-form">
                        <h2>
                            Sign Up
                        </h2>
                        <div class="form-group">
                            <label for="signup-name">
                                Name
                            </label>
                            <input id="signup-name" required="" type="text" />
                        </div>
                        <div class="form-group">
                            <label for="signup-email">
                                Email
                            </label>
                            <input id="signup-email" required="" type="email" />
                        </div>
                        <div class="form-group">
                            <label for="signup-password">
                                Password
                            </label>
                            <input id="signup-password" required="" type="password" />
                        </div>
                        <button class="btn btn-primary" type="submit">
                            Sign Up
                        </button>
                        <p class="toggle-auth">
                            Already have an account?
                            <a onclick="toggleAuthForms()">
                                Login
                            </a>
                        </p>
                    </form>
                </div>
            </div>
        </div>
        <div class="page hidden" id="admin-page">
            <div class="page-header">
                <div class="container">
                    <h1>
                        Admin Panel
                    </h1>
                </div>
            </div>
            <div class="page-content">
                <div class="container admin-panel">
                    <div class="admin-tabs">
                        <div class="admin-tab active" onclick="showAdminContent('orders')">
                            Orders
                        </div>
                        <div class="admin-tab" onclick="showAdminContent('products')">
                            Add Product
                        </div>
                        <div class="admin-tab" onclick="showAdminContent('manage')">
                            Manage Products
                        </div>
                    </div>
                    <div class="admin-content" id="admin-orders-content">
                        <h3 style="margin-bottom: 20px;">
                            Received Orders
                        </h3>
                        <div id="orders-list">
                        </div>
                    </div>
                    <div class="admin-content hidden" id="admin-products-content">
                        <h3 style="margin-bottom: 20px;">
                            Add a New Product
                        </h3>
                        <form id="add-product-form">
                            <div class="admin-product-form">
                                <div class="form-group">
                                    <label for="product-name">
                                        Product Name
                                    </label>
                                    <input id="product-name" required="" type="text" />
                                </div>
                                <div class="form-group">
                                    <label for="product-price">
                                        Price (PKR)
                                    </label>
                                    <input id="product-price" required="" type="number" />
                                </div>
                                <div class="form-group">
                                    <label for="product-category">
                                        Category
                                    </label>
                                    <select id="product-category" required=""
                                        style="width:100%; padding:12px; border: 1px solid #ccc; border-radius: 5px; font-size: 16px;">
                                        <option value="dry-fruits">
                                            Dry Fruits
                                        </option>
                                        <option value="herbal-tea">
                                            Herbal Tea
                                        </option>
                                        <option value="honey">
                                            Honey
                                        </option>
                                        <option value="seeds">
                                            Seeds
                                        </option>
                                        <option value="supplements">
                                            Supplements
                                        </option>
                                        <option value="capsules">
                                            Capsules
                                        </option>
                                        <option value="cold-pressed-oil">
                                            Cold Pressed Oil
                                        </option>
                                        <option value="essential-oils">
                                            Essential Oils
                                        </option>
                                        <option value="deals">
                                            Deals
                                        </option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="product-image-filename">
                                        Product Image Filename
                                    </label>
                                    <input id="product-image-filename" placeholder="e.g., my-image.jpg" required=""
                                        type="text" />
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label for="product-description">
                                        Description
                                    </label>
                                    <textarea id="product-description" required="" rows="4"></textarea>
                                </div>
                            </div>
                            <button class="btn btn-primary" style="margin-top: 20px; width: auto;" type="submit">
                                Add
                                Product
                            </button>
                        </form>
                    </div>
                    <div class="admin-content hidden" id="admin-manage-content">
                        <h3 style="margin-bottom: 20px;">
                            Manage Products
                        </h3>
                        <div id="admin-products-list">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <footer class="footer">
        <div class="container">
            <p>
                ¬© 2025 Herbal Store. All rights reserved. | Pakistan's Leading Herbal Online Store
            </p>
        </div>
    </footer>
    <script type="module">
        // Import the functions you need from the SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, doc, setDoc, getDocs, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // --- FIREBASE SETUP ---
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCJnref7x3qqdtlFGtt-c6lZjUcmlfYK0I",
            authDomain: "herbal-pansar.firebaseapp.com",
            projectId: "herbal-pansar",
            storageBucket: "herbal-pansar.appspot.com",
            messagingSenderId: "983071124936",
            appId: "1:983071124936:web:48a7cdd989a0d94d77e4fd",
            measurementId: "G-CR0L1L84WP"
        };

        // Initialize Firebase and Services
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- INITIAL DATABASE DATA ---
        const initialProducts = [];

        // --- STATE MANAGEMENT ---
        let allProducts = [];
        let cart = [];
        let lastViewedCategory = 'home';
        let currentUser = null;
        let slideIndex = 1;
        let slideInterval;
        let lastScrollY = 0;

        // --- DOM ELEMENTS ---
        const pages = document.querySelectorAll('.page');
        const cartTotalHeaderEl = document.getElementById('cart-total-header');
        const cartItemCountBadgeEl = document.querySelector('.cart-item-count-badge');
        const cartViewContainerEl = document.getElementById('cart-view-container');
        const checkoutFormEl = document.getElementById('checkout-form-element');
        const productDetailContentEl = document.getElementById('product-detail-content');
        const searchInputEl = document.getElementById('search-input');
        const mobileSearchInputEl = document.getElementById('mobile-search-input');
        const authControlsEl = document.getElementById('auth-controls');
        const loginFormEl = document.getElementById('login-form');
        const signupFormEl = document.getElementById('signup-form');
        const ordersListEl = document.getElementById('orders-list');
        const addProductFormEl = document.getElementById('add-product-form');
        const modalEl = document.getElementById('custom-modal');
        const modalMessageEl = document.getElementById('modal-message');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const mainHeader = document.getElementById('main-header');
        const mobileSearchOverlay = document.getElementById('mobile-search-overlay');
        const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
        const mobileMenuSidebar = document.getElementById('mobile-menu-sidebar');

        // --- MOBILE FUNCTIONALITY ---
        // Mobile header scroll behavior
        function handleScroll() {
            if (window.innerWidth <= 768) {
                const currentScrollY = window.scrollY;
                if (currentScrollY > lastScrollY && currentScrollY > 100) {
                    mainHeader.classList.add('hidden-mobile');
                } else {
                    mainHeader.classList.remove('hidden-mobile');
                }
                lastScrollY = currentScrollY;
            }
        }

        // Mobile search functions
        window.openMobileSearch = function () {
            mobileSearchOverlay.style.display = 'block';
            mobileSearchInputEl.focus();
        }

        window.closeMobileSearch = function () {
            mobileSearchOverlay.style.display = 'none';
            mobileSearchInputEl.value = '';
            document.getElementById('mobile-search-results-grid').innerHTML = '';
        }

        // Mobile menu functions
        window.openMobileMenu = function () {
            mobileMenuOverlay.style.display = 'block';
            setTimeout(() => {
                mobileMenuSidebar.classList.add('open');
            }, 10);
        }

        window.closeMobileMenu = function () {
            mobileMenuSidebar.classList.remove('open');
            setTimeout(() => {
                mobileMenuOverlay.style.display = 'none';
            }, 300);
        }

        // Handle mobile search
        function handleMobileSearch() {
            const query = mobileSearchInputEl.value.toLowerCase().trim();
            const resultsGrid = document.getElementById('mobile-search-results-grid');

            if (query.length === 0) {
                resultsGrid.innerHTML = '';
                return;
            }

            const results = allProducts.filter(p =>
                p.name.toLowerCase().includes(query) ||
                p.description.toLowerCase().includes(query)
            );

            renderProducts(results, 'mobile-search-results-grid');
        }

        // --- RENDER FUNCTIONS ---
        function renderAllGrids() {
            renderProducts(allProducts, 'all-products-grid');
            renderProducts(allProducts.filter(p => p.category === 'dry-fruits'), 'dry-fruits-grid');
            renderProducts(allProducts.filter(p => p.category === 'herbal-tea'), 'herbal-tea-grid');
            renderProducts(allProducts.filter(p => p.category === 'honey'), 'honey-grid');
            renderProducts(allProducts.filter(p => p.category === 'seeds'), 'seeds-grid');
            renderProducts(allProducts.filter(p => p.category === 'supplements'), 'supplements-grid');
            renderProducts(allProducts.filter(p => p.category === 'capsules'), 'capsules-grid');
            renderProducts(allProducts.filter(p => p.category === 'cold-pressed-oil'), 'cold-pressed-oil-grid');
            renderProducts(allProducts.filter(p => p.category === 'essential-oils'), 'essential-oils-grid');
            renderProducts(allProducts.filter(p => p.category === 'deals'), 'deals-grid');
        }

        function renderProducts(productsToRender, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;

            if (productsToRender.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #888; padding: 20px 0;">No products found in this category.</p>';
                return;
            }

            container.innerHTML = productsToRender.map(p => `
                <div class="product-card">
                    <div class="product-image" onclick="showProductPage('${p.id}')"><img src="${p.image}" alt="${p.name}" onerror="this.onerror=null;this.src='https://placehold.co/300x300/ccc/ffffff?text=Image+Not+Found';"></div>
                    <div class="product-info">
                        <h3 onclick="showProductPage('${p.id}')">${p.name}</h3>
                        <div class="product-price">
                            ${p.originalPrice ? `<span class="price-original">Rs.${p.originalPrice.toFixed(2)}</span>` : ''}
                            Rs.${p.price.toFixed(2)}
                        </div>
                        <div class="quantity-controls" data-product-id="${p.id}">
                            <button class="quantity-btn">-</button>
                            <input type="number" class="quantity-input" value="1" min="1">
                            <button class="quantity-btn">+</button>
                        </div>
                        <button class="btn-primary add-to-cart-btn" data-product-id="${p.id}">ADD TO CART</button>
                    </div>
                </div>
            `).join('');
        }

        function renderProductDetailPage(product) {
            if (!product) {
                productDetailContentEl.innerHTML = '<p>Product not found.</p>';
                return;
            }
            productDetailContentEl.innerHTML = `<a href="#" onclick="showPage(lastViewedCategory)" class="back-link">&larr; Back to products</a><div class="product-detail-container"><div class="product-detail-image"><img src="${product.image}" alt="${product.name}" onerror="this.onerror=null;this.src='https://placehold.co/400x400/ccc/ffffff?text=Image+Not+Found';"></div><div class="product-detail-info"><h1>${product.name}</h1><div class="product-price">${product.originalPrice ? `<span class="price-original">Rs.${product.originalPrice.toFixed(2)}</span>` : ''}Rs.${product.price.toFixed(2)}</div><p>${product.description || 'No description available.'}</p><div class="quantity-controls" data-product-id="${product.id}"><button class="quantity-btn">-</button><input type="number" class="quantity-input" value="1" min="1"><button class="quantity-btn">+</button></div><button class="btn-primary add-to-cart-btn" data-product-id="${product.id}" style="margin-top: 20px; width: auto;">ADD TO CART</button></div></div>`;
        }

        // Render admin products list for management
        function renderAdminProductsList() {
            const adminProductsListEl = document.getElementById('admin-products-list');
            if (!adminProductsListEl) return;

            if (allProducts.length === 0) {
                adminProductsListEl.innerHTML = '<p>No products found.</p>';
                return;
            }

            adminProductsListEl.innerHTML = allProducts.map(product => `
                <div class="admin-product-item">
                    <div class="admin-product-info">
                        <h4>${product.name}</h4>
                        <p>Price: Rs.${product.price.toFixed(2)} | Category: ${product.category}</p>
                        <p>ID: ${product.id}</p>
                    </div>
                    <div class="admin-product-actions">
                        <button class="btn-delete" onclick="deleteProduct('${product.id}')">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        // --- PAGE NAVIGATION ---
        window.showPage = function (pageId) {
            pages.forEach(page => page.classList.add('hidden'));
            const targetPage = document.getElementById(pageId + '-page');
            if (targetPage) {
                targetPage.classList.remove('hidden');
                if (!['cart', 'checkout', 'product-detail', 'order-success', 'login', 'admin', 'search-results'].includes(pageId)) {
                    lastViewedCategory = pageId;
                }
            }
            window.scrollTo(0, 0);

            if (pageId === 'checkout') renderCheckoutPage();
            if (pageId === 'admin') renderAdminPanel();

            // Close mobile overlays when navigating
            closeMobileSearch();
            closeMobileMenu();
        }

        window.showProductPage = function (productId) {
            const product = allProducts.find(p => p.id === productId);
            renderProductDetailPage(product);
            showPage('product-detail');
        }

        // --- SLIDER LOGIC ---
        window.plusSlides = function (n) {
            showSlides(slideIndex += n);
            resetSlideInterval();
        }

        window.currentSlideDot = function (n) {
            showSlides(slideIndex = n);
            resetSlideInterval();
        }

        function showSlides(n) {
            let slides = document.getElementsByClassName("slide");
            let dots = document.getElementsByClassName("dot");
            if (slides.length === 0) return;
            if (n > slides.length) { slideIndex = 1 }
            if (n < 1) { slideIndex = slides.length }
            for (let i = 0; i < slides.length; i++) {
                slides[i].style.display = "none";
            }
            for (let i = 0; i < dots.length; i++) {
                dots[i].className = dots[i].className.replace(" active-dot", "");
            }
            slides[slideIndex - 1].style.display = "block";
            dots[slideIndex - 1].className += " active-dot";
        }

        function resetSlideInterval() {
            clearInterval(slideInterval);
            slideInterval = setInterval(() => plusSlides(1), 5000);
        }

        // --- CART LOGIC ---
        function addToCart(productId, quantity) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;
            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({ ...product, quantity: quantity });
            }
            updateCartDisplay();
            showAlert(`${product.name} added to cart!`);
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartDisplay();
        }

        function updateCartDisplay() {
            renderCartPage();
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            cartTotalHeaderEl.textContent = total.toFixed(2);
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartItemCountBadgeEl.textContent = totalItems;
        }

        function renderCartPage() {
            if (!cartViewContainerEl) return;
            if (cart.length === 0) {
                cartViewContainerEl.innerHTML = '<p class="cart-empty-message">Your cart is currently empty.</p>';
                return;
            }
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            cartViewContainerEl.innerHTML = `<div class="cart-container"><div class="cart-items">${cart.map(item => `<div class="cart-item"><div class="cart-item-details"><div class="cart-item-image"><img src="${item.image}" alt="${item.name}" onerror="this.onerror=null;this.src='https://placehold.co/60x60/ccc/ffffff?text=N/A';"></div><div class="cart-item-info"><h4>${item.name}</h4><p class="cart-item-price">Rs.${item.price.toFixed(2)} x ${item.quantity}</p></div></div><div class="cart-item-actions"><strong>Rs.${(item.price * item.quantity).toFixed(2)}</strong><button class="remove-from-cart-btn" data-product-id="${item.id}">Remove</button></div></div>`).join('')}</div><div class="cart-summary"><h3>Order Summary</h3><p><span>Subtotal</span> <span>Rs.${total.toFixed(2)}</span></p><p><span>Shipping</span> <span>${total >= 2000 ? 'Free' : 'Rs.200'}</span></p><hr><p class="total"><span>Total</span> <span>Rs.${(total + (total < 2000 ? 200 : 0)).toFixed(2)}</span></p><button class="btn-primary" onclick="showPage('checkout')">Proceed to Checkout</button></div></div>`;
        }

        // --- CHECKOUT LOGIC ---
        function renderCheckoutPage() {
            const guestEmailGroup = document.getElementById('guest-email-group');
            const emailInput = document.getElementById('email');

            if (!currentUser) {
                guestEmailGroup.classList.remove('hidden');
                emailInput.required = true;
            } else {
                guestEmailGroup.classList.add('hidden');
                emailInput.required = false;
            }

            const summaryContainer = document.getElementById('checkout-summary-container');
            if (!summaryContainer) return;
            if (cart.length === 0) {
                showAlert("Your cart is empty. Add items before checking out.");
                showPage('cart');
                return;
            }
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const shipping = subtotal >= 2000 ? 0 : 200;
            const total = subtotal + shipping;
            summaryContainer.innerHTML = `${cart.map(item => `<div class="summary-item"><span>${item.name} (x${item.quantity})</span><span>Rs.${(item.price * item.quantity).toFixed(2)}</span></div>`).join('')}<div class="summary-item" style="margin-top: 10px;"><span>Subtotal</span><span>Rs.${subtotal.toFixed(2)}</span></div><div class="summary-item"><span>Shipping</span><span>Rs.${shipping.toFixed(2)}</span></div><div class="summary-total"><span>Total</span><span>Rs.${total.toFixed(2)}</span></div>`;
        }

        window.showPaymentContent = function (method) {
            document.querySelectorAll('.payment-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(`${method}-content`).classList.remove('hidden');
            document.querySelectorAll('.payment-tab').forEach(el => el.classList.remove('active'));
            document.querySelector(`.payment-tab[onclick="showPaymentContent('${method}')"]`).classList.add('active');
        }

        // --- PRODUCT MANAGEMENT ---
        window.deleteProduct = async function (productId) {
            if (!confirm('Are you sure you want to delete this product?')) {
                return;
            }

            try {
                await deleteDoc(doc(db, "products", productId));
                allProducts = allProducts.filter(p => p.id !== productId);
                renderAllGrids();
                renderAdminProductsList();
                showAlert("Product deleted successfully!");
            } catch (error) {
                console.error("Error deleting product: ", error);
                showAlert("Failed to delete product. Please try again.");
            }
        }

        // --- AUTHENTICATION & ADMIN (LOCAL STORAGE) ---
        window.toggleAuthForms = function () {
            loginFormEl.classList.toggle('hidden');
            signupFormEl.classList.toggle('hidden');
            loginFormEl.reset();
            signupFormEl.reset();
        }

        function updateAuthControls() {
            if (currentUser) {
                let welcomeMessage = `Welcome, ${currentUser.name}`;
                if (currentUser.role === 'admin') {
                    welcomeMessage += ` | <a href="#" onclick="showPage('admin')">Admin Panel</a>`;
                }
                welcomeMessage += ` | <a href="#" onclick="logout()">Logout</a>`;
                authControlsEl.innerHTML = welcomeMessage;
            } else {
                authControlsEl.innerHTML = `<a href="#" onclick="showPage('login')">Login</a>`;
            }
        }

        window.logout = function () {
            currentUser = null;
            localStorage.removeItem('currentUser');
            updateAuthControls();
            showPage('home');
            showAlert("You have been logged out.");
        }

        function renderAdminPanel() {
            if (!currentUser || currentUser.role !== 'admin') {
                showAlert("You do not have permission to view this page.");
                showPage('home');
                return;
            }
            // Firestore listener for orders
            const q = query(collection(db, "orders"));
            onSnapshot(q, (querySnapshot) => {
                const orders = [];
                querySnapshot.forEach((doc) => {
                    orders.push({ id: doc.id, ...doc.data() });
                });
                renderOrders(orders);
            });

            // Render products list for management
            renderAdminProductsList();
        }

        window.showAdminContent = function (contentType) {
            document.querySelectorAll('.admin-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(`admin-${contentType}-content`).classList.remove('hidden');
            document.querySelectorAll('.admin-tab').forEach(el => el.classList.remove('active'));
            document.querySelector(`.admin-tab[onclick="showAdminContent('${contentType}')"]`).classList.add('active');

            if (contentType === 'manage') {
                renderAdminProductsList();
            }
        }

        function renderOrders(orders) {
            if (orders.length === 0) {
                ordersListEl.innerHTML = '<p>No orders received yet.</p>';
                return;
            }
            // Sort orders by date, newest first
            orders.sort((a, b) => new Date(b.date) - new Date(a.date));

            ordersListEl.innerHTML = orders.map(order => {
                const isFulfilled = order.status === 'fulfilled';
                let orderItemsHtml = '';
                if (order.items && Array.isArray(order.items)) {
                    orderItemsHtml = order.items.map(item => `<li>${item.name} (x${item.quantity})</li>`).join('');
                }

                return `
                    <div class="order-record">
                        <h4>Order from: ${order.customer.name}</h4>
                        <p><strong>Order ID:</strong> ${order.id}</p>
                        <p><strong>Date:</strong> ${new Date(order.date).toLocaleString()}</p>
                        <p><strong>Contact:</strong> ${order.customer.email} | ${order.customer.phone}</p>
                        <p><strong>Address:</strong> ${order.customer.address}</p>
                        <p><strong>Payment Method:</strong> ${order.paymentMethod}</p>
                        <p><strong>Total:</strong> Rs. ${order.total.toFixed(2)}</p>
                        <details>
                            <summary>View Items (${order.items.length})</summary>
                            <ul>${orderItemsHtml}</ul>
                        </details>
                        <button 
                            class="btn-fulfillment ${isFulfilled ? 'fulfilled' : ''}" 
                            data-order-id="${order.id}" 
                            ${isFulfilled ? 'disabled' : ''}>
                            ${isFulfilled ? 'Fulfilled' : 'Mark as Fulfilled'}
                        </button>
                    </div>
                `
            }).join('');
        }

        // --- MODAL & SEARCH ---
        function showAlert(message) {
            modalMessageEl.textContent = message;
            modalEl.classList.remove('hidden');
        }

        function handleSearch() {
            const query = searchInputEl.value.toLowerCase().trim();
            if (query.length === 0) {
                showPage(lastViewedCategory || 'home');
                return;
            };
            const results = allProducts.filter(p => p.name.toLowerCase().includes(query) || p.description.toLowerCase().includes(query));
            renderProducts(results, 'search-results-grid');
            showPage('search-results');
            document.getElementById('search-results-title').textContent = `Results for "${query}"`;
        }

        // --- EVENT LISTENERS ---
        document.addEventListener('click', async function (e) {
            if (e.target.classList.contains('add-to-cart-btn')) {
                const productId = e.target.dataset.productId;
                const controls = e.target.closest('.product-info, .product-detail-info');
                const quantity = parseInt(controls.querySelector('.quantity-input').value);
                addToCart(productId, quantity);
            }
            if (e.target.classList.contains('quantity-btn')) {
                const input = e.target.parentNode.querySelector('.quantity-input');
                let value = parseInt(input.value);
                if (e.target.textContent === '+') value++;
                else if (value > 1) value--;
                input.value = value;
            }
            if (e.target.classList.contains('remove-from-cart-btn')) {
                const productId = e.target.dataset.productId;
                removeFromCart(productId);
            }
            // Fulfillment button listener
            if (e.target.classList.contains('btn-fulfillment') && !e.target.disabled) {
                const orderId = e.target.dataset.orderId;
                const orderRef = doc(db, "orders", orderId);
                try {
                    await updateDoc(orderRef, {
                        status: "fulfilled"
                    });
                    showAlert(`Order ${orderId} marked as fulfilled.`);
                } catch (error) {
                    console.error("Error updating order status: ", error);
                    showAlert("Failed to update order status.");
                }
            }
        });

        // Close mobile overlays when clicking outside
        mobileSearchOverlay.addEventListener('click', (e) => {
            if (e.target === mobileSearchOverlay) {
                closeMobileSearch();
            }
        });

        mobileMenuOverlay.addEventListener('click', (e) => {
            if (e.target === mobileMenuOverlay) {
                closeMobileMenu();
            }
        });

        modalCloseBtn.addEventListener('click', () => modalEl.classList.add('hidden'));
        modalEl.addEventListener('click', (e) => { if (e.target === modalEl) modalEl.classList.add('hidden'); });

        searchInputEl.addEventListener('keyup', handleSearch);
        mobileSearchInputEl.addEventListener('keyup', handleMobileSearch);

        // Add scroll listener for mobile header
        window.addEventListener('scroll', handleScroll);

        // Handle window resize
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                mainHeader.classList.remove('hidden-mobile');
                closeMobileSearch();
                closeMobileMenu();
            }
        });

        loginFormEl.addEventListener('submit', function (e) {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            if (email === 'admin@gmail.com' && password === 'admin123') {
                currentUser = { name: 'Admin', email: 'admin@gmail.com', role: 'admin' };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                updateAuthControls();
                showPage('admin');
                loginFormEl.reset();
                return;
            }

            const users = JSON.parse(localStorage.getItem('users')) || [];
            const user = users.find(u => u.email === email && u.password === password);
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                updateAuthControls();
                showPage('home');
                loginFormEl.reset();
            } else {
                showAlert("Invalid email or password.");
            }
        });

        signupFormEl.addEventListener('submit', function (e) {
            e.preventDefault();
            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            let users = JSON.parse(localStorage.getItem('users')) || [];
            if (users.some(u => u.email === email)) {
                showAlert("An account with this email already exists.");
                return;
            }
            const newUser = { name, email, password, role: 'customer' };
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            showAlert("Signup successful! Please login.");
            toggleAuthForms();
        });

        checkoutFormEl.addEventListener('submit', async function (e) {
            e.preventDefault();

            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const shipping = subtotal >= 2000 ? 0 : 200;
            const total = subtotal + shipping;

            const newOrder = {
                date: new Date().toISOString(),
                customer: {
                    name: document.getElementById('fullName').value,
                    email: currentUser ? currentUser.email : document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    address: document.getElementById('address').value,
                },
                items: cart,
                paymentMethod: document.querySelector('.payment-tab.active').textContent,
                total: total,
                status: 'pending'
            };

            try {
                const docRef = await addDoc(collection(db, "orders"), newOrder);
                console.log("Order written with ID: ", docRef.id);
                showPage('order-success');
                cart = [];
                updateCartDisplay();
                checkoutFormEl.reset();
            } catch (error) {
                console.error("Error adding order to Firestore: ", error);
                showAlert('There was a problem placing your order. Please try again.');
            }
        });

        addProductFormEl.addEventListener('submit', async function (e) {
            e.preventDefault();
            const submitButton = addProductFormEl.querySelector('button[type="submit"]');

            const name = document.getElementById('product-name').value;
            const price = parseFloat(document.getElementById('product-price').value);
            const category = document.getElementById('product-category').value;
            const description = document.getElementById('product-description').value;
            const imageFilename = document.getElementById('product-image-filename').value;

            if (!imageFilename) {
                showAlert("Please enter the image filename.");
                return;
            }

            submitButton.disabled = true;
            submitButton.textContent = 'Adding...';

            try {
                const imageUrl = `images/${imageFilename}`;
                const newProduct = {
                    id: String(Date.now()),
                    name,
                    price,
                    category,
                    description,
                    image: imageUrl,
                };

                await setDoc(doc(db, "products", newProduct.id), newProduct);

                showAlert("Product added successfully!");
                allProducts.push(newProduct);
                renderAllGrids();
                renderAdminProductsList();
                addProductFormEl.reset();
            } catch (error) {
                console.error("Error adding product: ", error);
                showAlert(`Failed to add product. Error: ${error.message}`);
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = 'Add Product';
            }
        });

        // --- INITIALIZATION ---
        async function initializeStore() {
            // Load user from local storage
            try {
                const loggedInUser = JSON.parse(localStorage.getItem('currentUser'));
                if (loggedInUser) {
                    currentUser = loggedInUser;
                }
            } catch (error) {
                console.error("Could not parse user from local storage:", error);
                localStorage.removeItem('currentUser');
            }
            updateAuthControls();

            // Fetch products from Firestore
            try {
                const productsCollection = collection(db, "products");
                const productSnapshot = await getDocs(productsCollection);

                if (productSnapshot.empty && initialProducts.length > 0) {
                    console.log("No products found in Firestore. Populating with initial data...");
                    const batch = [];
                    initialProducts.forEach(p => {
                        const docRef = doc(db, "products", p.id);
                        batch.push(setDoc(docRef, p));
                    });
                    await Promise.all(batch);
                    allProducts = initialProducts;
                } else {
                    allProducts = productSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                }
                renderAllGrids();
            } catch (error) {
                console.error("Error fetching products from Firestore: ", error);
                showAlert("Could not load products. Please check your connection and Firebase setup.");
            }

            // Initial UI setup
            updateCartDisplay();
            showSlides(slideIndex);
            resetSlideInterval();
        }

        // Run the store on window load
        window.onload = initializeStore;
    </script>
</body>

</html>